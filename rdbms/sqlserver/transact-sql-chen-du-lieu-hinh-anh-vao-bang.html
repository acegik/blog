<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>TRANSACT-SQL: CHèN Dữ LIệU HìNH ảNH VàO BảNG &vert; ACEGIK'S BLOG</title>
<meta name="description" content="... when the sun comes up, you better be running!">
<meta name="keywords" content="SQLServer, Transact-SQL">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/blog/images/logo.png">
<meta name="twitter:title" content="Transact-SQL: Chèn dữ liệu hình ảnh vào bảng">
<meta name="twitter:description" content="... when the sun comes up, you better be running!">
<meta name="twitter:creator" content="@pnhung177">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Transact-SQL: Chèn dữ liệu hình ảnh vào bảng">
<meta property="og:description" content="... when the sun comes up, you better be running!">
<meta property="og:url" content="/blog/rdbms/sqlserver/transact-sql-chen-du-lieu-hinh-anh-vao-bang.html">
<meta property="og:site_name" content="Acegik's Blog">
<meta property="og:image" content="/blog/images/">





<link rel="canonical" href="/blog/rdbms/sqlserver/transact-sql-chen-du-lieu-hinh-anh-vao-bang.html">
<link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Acegik's Blog Feed">
<link rel="author" href="https://plus.google.com/u/3/115458186421626071505?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/blog/assets/css/font-awesome.min.css">
<link rel="stylesheet" href="/blog/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/blog/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/blog/assets/css/style.css">
<link rel="stylesheet" href="/blog/assets/css/post.css">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/blog/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>





<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/blog/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/blog/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/blog/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/blog/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/blog/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/images/apple-touch-icon-144x144-precomposed.png">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Acegik - sidebar -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2558234225933836"
     data-ad-slot="3073080904"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">


        <main id="cheryk-post-container-simple" class="cheryk-post-container-simple" role="main">
            <header class="cheryk-post-header-simple">
                <div class="cheryk-post-menu-header-simple">

                    <a class="cheryk-blog-logo" href="/blog">
                        <img src="/blog/images/logo.png" alt="Blog Logo" />
                    </a>

                <div class="cheryk-blog-menu">      
    <div class="cheryk-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="cheryk-menu">
        <li class="cheryk-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="/blog/">Trang bìa</a>
                 </li>

            <li>
                    <a href="/blog/featured">Danh sách</a>
                 </li>

            <li>
                    <a href="/blog/categories">Phân loại</a>
                 </li>

            <li>
                    <a href="/blog/about">Giới thiệu</a>
                 </li>
            
           <li><a href="/blog/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

                <div class="cheryk-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="cheryk-post-meta-simple">
                            <h1>Transact-SQL: Chèn dữ liệu hình ảnh vào bảng</h1>
                            <p>by <strong>pnhung177</strong> &#8212; on <a href="/blog/tags/index.html#SQLServer" data-toggle="tooltip" title="Posts tagged with SQLServer" rel="tag">SQLServer</a>&nbsp;&comma;&nbsp;<a href="/blog/tags/index.html#Transact-SQL" data-toggle="tooltip" title="Posts tagged with Transact-SQL" rel="tag">Transact-SQL</a> &#8212; <strong><time datetime="2008-07-23T00:00:00+07:00">23/07/2008</time></strong></p>
                        </div>
                    </div>
                </div>
            </header>

        <article class="cheryk-post-content post tag-simple">
            <div><p>Mặc dù không khuyến khích lưu trữ và truy vấn trực tiếp dữ liệu hình ảnh (picture) trong bảng (table) bên trong cơ sở dữ liệu, tuy nhiên nhiều ứng dụng vẫn muốn lưu trữ hình ảnh trong bảng để đảm bảo tính toán vẹn của dữ liệu. Các ứng dụng này sẽ cung cấp thêm chức năng tạo bản copy của hình ảnh vào một thư mục tạm để truy vấn nhanh chóng. Bài viết này giới thiệu cách thức lưu trữ hình ảnh vào trong bảng của CSDL SQL Server.</p>

<h2 id="to-bng-d-liu-mu">Tạo bảng dữ liệu mẫu</h2>

<p>Đầu tiên, tạo bảng dữ liệu lưu thông tin về nhân viên (Employees) như sau:</p>

<p><img src="/blog/media/0060bd1b-be60-4561-bcdd-d2b326edfb7c/create-table.png" alt="Tạo bảng dữ liệu" /></p>

<h2 id="chn-th-mt-bn-ghi">Chèn thử một bản ghi</h2>

<p>Sử dụng câu lệnh INSERT để chèn thử một bản ghi vào trong bảng Employees:</p>

<p><img src="/blog/media/0060bd1b-be60-4561-bcdd-d2b326edfb7c/insert-image.png" alt="Sử dụng lệnh Insert chèn ảnh" /></p>

<p>Sử dụng truy vấn để kiểm tra kết quả:</p>

<p><img src="/blog/media/0060bd1b-be60-4561-bcdd-d2b326edfb7c/insert-verify-by-select.png" alt="Kiểm tra kết quả Insert" /></p>

<p>Kết quả chèn:</p>

<p><img src="/blog/media/0060bd1b-be60-4561-bcdd-d2b326edfb7c/insert-result.png" alt="Kết quả chèn bằng Insert" /></p>

<h2 id="to-procedure-chn-bn-ghi">Tạo PROCEDURE chèn bản ghi</h2>

<p>Để thuận tiện cho việc sử dụng, ta tạo một STORED PROCEDURE để chèn thêm bản ghi (có chứa tệp ảnh) vào:</p>

<p><img src="/blog/media/0060bd1b-be60-4561-bcdd-d2b326edfb7c/procedure-define.png" alt="Tạo Procedure" /></p>

<p>Lưu ý: Vì hàm OPENROWSET không cho phép đối số là biến (variable, ví dụ @a, @filename,…) nên ta phải tạo ra câu lệnh SQL để thêm các đối số vào, sau đó dùng EXEC() để gián tiếp thực thi câu lệnh chèn.</p>

<p>Sử dụng PROCEDURE trên để chèn thử một bản ghi:</p>

<p><img src="/blog/media/0060bd1b-be60-4561-bcdd-d2b326edfb7c/procedure-execute.png" alt="Sử dụng Procedure" /></p>

<p>Kết quả thu được:</p>

<p><img src="/blog/media/0060bd1b-be60-4561-bcdd-d2b326edfb7c/procedure-result.png" alt="Kết quả thực thi Procedure" /></p>


            </div>
        </article>

        <div class="cf"></div>
        <div class="row text-center">
            <section class="cheryk-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Transact-SQL: Chèn dữ liệu hình ảnh vào bảng&quot;%20/blog/rdbms/sqlserver/transact-sql-chen-du-lieu-hinh-anh-vao-bang.html%20via%20&#64;pnhung177"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=/blog/rdbms/sqlserver/transact-sql-chen-du-lieu-hinh-anh-vao-bang.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=/blog/rdbms/sqlserver/transact-sql-chen-du-lieu-hinh-anh-vao-bang.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>
        <div class="cf"></div>
            <div class="cheryk-author-info">
                <div class="row">
                    <section class="cheryk-post-author small-12 columns">
                        
                            <img src="/blog/images/avatars/pnhung177.png" class="cheryk-post-author-avatar" alt="Phạm Ngọc Hùng's photo">
                        
                            <span class="author-label">Author</span>
                            <h1>Phạm Ngọc Hùng</h1>
                        
                            <p><a href="mailto:pnhung177@drupalex.net" class="author-website">pnhung177@drupalex.net</a></p>
                        
                            <p>... when the sun comes up, you better be running!</p>
                        
                    </section>
                </div>
            </div> 
        <div class="cf"></div>

        
        <section class="cheryk-disqus row">
    <div class="small-12 columns">
        <h1 class="cheryk-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'acegik'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

         
</main> 


<div class="cf"></div>
<footer class="cheryk-site-footer">
    <div class="copyright">
         <section>Bản quyền nội dung thuộc về <a href="/blog/about">Phạm Ngọc Hùng</a> &copy; 2015.</section>
    </div>
    <div class="social-icons">
        
        
        <a href="http://twitter.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="https://plus.google.com/u/3/115458186421626071505">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-google-plus fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://github.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://facebook.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        
    </div>
    
    <div class="cf"></div>
</footer>

<script src="/blog/assets/js/vendor/modernizr.js"></script>
<script src="/blog/assets/js/foundation.min.js"></script>
<script src="/blog/assets/js/vendor/background-check.js"></script>
<script src="/blog/assets/js/vendor/post-header-animations.js"></script>
<script src="/blog/assets/js/main.js"></script>

<script>
  $(document).foundation();
</script>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54128248-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>


  
</body>
</html>
