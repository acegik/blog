<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>TRANSACT-SQL: Ví Dụ MINH HọA Về INNER JOIN Và OUTER JOIN &vert; ACEGIK'S BLOG</title>
<meta name="description" content="... when the sun comes up, you better be running!">
<meta name="keywords" content="SQLServer, Transact-SQL">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/blog/images/logo.png">
<meta name="twitter:title" content="Transact-SQL: Ví dụ minh họa về Inner Join và Outer Join">
<meta name="twitter:description" content="... when the sun comes up, you better be running!">
<meta name="twitter:creator" content="@pnhung177">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Transact-SQL: Ví dụ minh họa về Inner Join và Outer Join">
<meta property="og:description" content="... when the sun comes up, you better be running!">
<meta property="og:url" content="/blog/rdbms/sqlserver/transact-sql-vi-du-minh-hoa-inner-join-va-outer-join.html">
<meta property="og:site_name" content="Acegik's Blog">
<meta property="og:image" content="/blog/images/">





<link rel="canonical" href="/blog/rdbms/sqlserver/transact-sql-vi-du-minh-hoa-inner-join-va-outer-join.html">
<link href="/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Acegik's Blog Feed">
<link rel="author" href="https://plus.google.com/u/3/115458186421626071505?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/blog/assets/css/font-awesome.min.css">
<link rel="stylesheet" href="/blog/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/blog/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/blog/assets/css/style.css">
<link rel="stylesheet" href="/blog/assets/css/post.css">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/blog/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>





<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/blog/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/blog/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/blog/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/blog/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/blog/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/images/apple-touch-icon-144x144-precomposed.png">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Acegik - sidebar -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2558234225933836"
     data-ad-slot="3073080904"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">


        <main id="cheryk-post-container-simple" class="cheryk-post-container-simple" role="main">
            <header class="cheryk-post-header-simple">
                <div class="cheryk-post-menu-header-simple">

                    <a class="cheryk-blog-logo" href="/blog">
                        <img src="/blog/images/logo.png" alt="Blog Logo" />
                    </a>

                <div class="cheryk-blog-menu">      
    <div class="cheryk-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="cheryk-menu">
        <li class="cheryk-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="/blog/">Trang bìa</a>
                 </li>

            <li>
                    <a href="/blog/featured">Danh sách</a>
                 </li>

            <li>
                    <a href="/blog/categories">Phân loại</a>
                 </li>

            <li>
                    <a href="/blog/about">Giới thiệu</a>
                 </li>
            
           <li><a href="/blog/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

                <div class="cheryk-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="cheryk-post-meta-simple">
                            <h1>Transact-SQL: Ví dụ minh họa về Inner Join và Outer Join</h1>
                            <p>by <strong>pnhung177</strong> &#8212; on <a href="/blog/tags/index.html#SQLServer" data-toggle="tooltip" title="Posts tagged with SQLServer" rel="tag">SQLServer</a>&nbsp;&comma;&nbsp;<a href="/blog/tags/index.html#Transact-SQL" data-toggle="tooltip" title="Posts tagged with Transact-SQL" rel="tag">Transact-SQL</a> &#8212; <strong><time datetime="2008-07-26T00:00:00+07:00">26/07/2008</time></strong></p>
                        </div>
                    </div>
                </div>
            </header>

        <article class="cheryk-post-content post tag-simple">
            <div><p>Thao tác nối bảng (Join) trong lệnh truy vấn dữ liệu SELECT có nhiều biến thể (inner join, các dạng outer join). Việc hiểu rõ cách dùng chúng rất quan trọng trong việc lập trình các ứng dụng cần lưu trữ dữ liệu trong CSDL quan hệ. Bài viết này trình bày về một ví dụ đơn giản minh họa việc sử dụng các biến thể của thao tác nối bảng JOIN.</p>

<h2 id="to-d-liu-minh-ha">Tạo dữ liệu minh họa</h2>

<p>Tạo 2 bảng dữ liệu A và B:</p>

<p><img src="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/create-table-A-and-B.png" alt="Tạo bảng dữ liệu A &amp; B" /></p>

<p>Chèn dữ liệu minh hoạ cho Bảng A và B:</p>

<p><img src="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/insert-into-A.png" alt="Chèn dữ liệu minh họa cho A" /></p>

<p><img src="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/insert-into-B.png" alt="Chèn dữ liệu minh họa cho B" /></p>

<h2 id="inner-join">INNER JOIN</h2>

<p>Thực hiện truy vấn từ 2 Table A và B, với điều kiện B.A_B = A.A1:</p>

<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">A_B</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span> <span class="k">from</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="k">where</span> <span class="n">A_B</span> <span class="o">=</span> <span class="n">A1</span><span class="p">;</span></code></pre></div>

<p>Kết quả truy vấn như sau:</p>

<p><img src="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/inner-join.png" alt="Kết quả truy vấn Inner Join" /></p>

<p>Ta có nhận xét là các bản ghi nằm trong bảng A và bảng B mà không có quan hệ với nhau đều bị loại khỏi kết quả truy vấn trên.</p>

<p>Ta có thể viết câu lệnh SQL trên theo một cú pháp tương đương khác như sau:</p>

<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">A_B</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span> <span class="k">from</span> <span class="n">A</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">B</span> <span class="k">ON</span> <span class="n">A_B</span> <span class="o">=</span> <span class="n">A1</span><span class="p">;</span></code></pre></div>

<h2 id="left-outer-join">LEFT OUTER JOIN</h2>

<p>Trong trường hợp ta muốn truy vấn nối 2 Table A và B, đồng thời lại muốn hiển thị tất các bản ghi của Table A cho dù các bản ghi này không có bản ghi nào thuộc Table liên kết tới, thì ta cần sử dụng OUTER JOIN. Lưu ý là ta chỉ lấy tất cả bản ghi của Table A, ở phía trái của phép nối, nên ta sử dụng LEFT OUTER JOIN.</p>

<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">A_B</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span> <span class="k">from</span> <span class="n">A</span> <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">B</span> <span class="k">on</span> <span class="n">B</span><span class="p">.</span><span class="n">A_B</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">A1</span><span class="p">;</span></code></pre></div>

<p>Kết quả thực hiện lệnh truy vấn trên:</p>

<p><img src="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/left-outer-join.png" alt="Kết quả truy vấn Left Outer Join" /></p>

<h2 id="right-outer-join">RIGHT OUTER JOIN</h2>

<p>Ngược lại, một số trường hợp ta cần truy vấn ghép nối 2 Table A, B và chọn ra cả những bản ghi của B không tham chiếu đến bản ghi nào của A. Vì các bản ghi được chọn nằm về bên phải của phép nối nên ta sử dụng mệnh đề RIGHT OUTER JOIN trong câu lệnh truy vấn:</p>

<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">A_B</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span> <span class="k">from</span> <span class="n">A</span> <span class="k">right</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">B</span> <span class="k">on</span> <span class="n">B</span><span class="p">.</span><span class="n">A_B</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">A1</span><span class="p">;</span></code></pre></div>

<p>Kết quả thực hiện lệnh truy vấn trên:</p>

<p><img src="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/right-outer-join.png" alt="Kết quả truy vấn Right Outer Join" /></p>

<h2 id="full-outer-join">FULL OUTER JOIN</h2>

<p>Trong trường hợp muốn truy vấn nối table A và B để chọn ra:</p>

<ul>
  <li>các bản ghi của A nối với các bản ghi của B tham chiếu đến A</li>
  <li>tất cả các bản ghi A không có bản ghi nào của B tham chiếu đến</li>
  <li>tất cả các bản ghi B không tham chiếu đến bản ghi nào của A</li>
</ul>

<p>thì ta có thể sử dụng câu lệnh truy vấn FULL OUTER JOIN:</p>

<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">A_B</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span> <span class="k">from</span> <span class="n">A</span> <span class="k">full</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">B</span> <span class="k">on</span> <span class="n">B</span><span class="p">.</span><span class="n">A_B</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">A1</span><span class="p">;</span></code></pre></div>

<p>Kết quả thực hiện câu lệnh:</p>

<p><img src="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/full-outer-join.png" alt="Kết quả truy vấn Full Outer Join" /></p>

<p>Các bạn có thể tải <a href="/blog/media/75d02963-dcd5-4d08-bcb2-abda23a0f299/transact-sql-join-example.zip">mã nguồn</a> của ví dụ minh họa trên để thử nghiệm.</p>

            </div>
        </article>

        <div class="cf"></div>
        <div class="row text-center">
            <section class="cheryk-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Transact-SQL: Ví dụ minh họa về Inner Join và Outer Join&quot;%20/blog/rdbms/sqlserver/transact-sql-vi-du-minh-hoa-inner-join-va-outer-join.html%20via%20&#64;pnhung177"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=/blog/rdbms/sqlserver/transact-sql-vi-du-minh-hoa-inner-join-va-outer-join.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=/blog/rdbms/sqlserver/transact-sql-vi-du-minh-hoa-inner-join-va-outer-join.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>
        <div class="cf"></div>
            <div class="cheryk-author-info">
                <div class="row">
                    <section class="cheryk-post-author small-12 columns">
                        
                            <img src="/blog/images/avatars/pnhung177.png" class="cheryk-post-author-avatar" alt="Phạm Ngọc Hùng's photo">
                        
                            <span class="author-label">Author</span>
                            <h1>Phạm Ngọc Hùng</h1>
                        
                            <p><a href="mailto:pnhung177@drupalex.net" class="author-website">pnhung177@drupalex.net</a></p>
                        
                            <p>... when the sun comes up, you better be running!</p>
                        
                    </section>
                </div>
            </div> 
        <div class="cf"></div>

        
        <section class="cheryk-disqus row">
    <div class="small-12 columns">
        <h1 class="cheryk-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'acegik'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

         
</main> 


<div class="cf"></div>
<footer class="cheryk-site-footer">
    <div class="copyright">
         <section>Bản quyền nội dung thuộc về <a href="/blog/about">Phạm Ngọc Hùng</a> &copy; 2015.</section>
    </div>
    <div class="social-icons">
        
        
        <a href="http://twitter.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="https://plus.google.com/u/3/115458186421626071505">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-google-plus fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://github.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://facebook.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        
    </div>
    
    <div class="cf"></div>
</footer>

<script src="/blog/assets/js/vendor/modernizr.js"></script>
<script src="/blog/assets/js/foundation.min.js"></script>
<script src="/blog/assets/js/vendor/background-check.js"></script>
<script src="/blog/assets/js/vendor/post-header-animations.js"></script>
<script src="/blog/assets/js/main.js"></script>

<script>
  $(document).foundation();
</script>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54128248-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>


  
</body>
</html>
