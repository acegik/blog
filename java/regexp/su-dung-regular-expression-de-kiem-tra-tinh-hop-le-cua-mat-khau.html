<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Sử DụNG REGULAR EXPRESSION để KIểM TRA TíNH HợP Lệ CủA MậT KHẩU &vert; ACEGIK'S BLOG</title>
<meta name="description" content="... when the sun comes up, you better be running!">
<meta name="keywords" content="Java, Regular Expression, Password Policy">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://acegik.net/blog/images/logo.png">
<meta name="twitter:title" content="Sử dụng Regular Expression để kiểm tra tính hợp lệ của mật khẩu">
<meta name="twitter:description" content="... when the sun comes up, you better be running!">
<meta name="twitter:creator" content="@pnhung177">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Sử dụng Regular Expression để kiểm tra tính hợp lệ của mật khẩu">
<meta property="og:description" content="... when the sun comes up, you better be running!">
<meta property="og:url" content="http://acegik.net/blog/java/regexp/su-dung-regular-expression-de-kiem-tra-tinh-hop-le-cua-mat-khau.html">
<meta property="og:site_name" content="Acegik's Blog">
<meta property="og:image" content="http://acegik.net/blog/images/">





<link rel="canonical" href="http://acegik.net/blog/java/regexp/su-dung-regular-expression-de-kiem-tra-tinh-hop-le-cua-mat-khau.html">
<link href="http://acegik.net/blog/feed.xml" type="application/atom+xml" rel="alternate" title="Acegik's Blog Feed">
<link rel="author" href="https://plus.google.com/u/3/115458186421626071505?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />


    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://acegik.net/blog/assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://acegik.net/blog/assets/css/vendor/normalize.css">
    <link rel="stylesheet" href="http://acegik.net/blog/assets/css/vendor/foundation.min.css">
    <link rel="stylesheet" href="http://acegik.net/blog/assets/css/style.css">
    <link rel="stylesheet" href="http://acegik.net/blog/assets/css/post.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="http://acegik.net/blog/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
    





<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://acegik.net/blog/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://acegik.net/blog/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://acegik.net/blog/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://acegik.net/blog/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://acegik.net/blog/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://acegik.net/blog/images/apple-touch-icon-144x144-precomposed.png">

</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  

        <main id="summer-post-container-simple" class="summer-post-container-simple" role="main">
            <header class="summer-post-header-simple">
                <div class="summer-post-menu-header-simple">

                    <a class="summer-blog-logo" href="http://acegik.net/blog">
                        <img src="http://acegik.net/blog/images/logo.png" alt="Blog Logo" />
                    </a>

                <div class="summer-blog-menu">      
    <div class="summer-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="summer-menu">
        <li class="summer-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="http://acegik.net/blog/">Trang bìa</a>
                 </li>

            <li>
                    <a href="http://acegik.net/blog/featured">Nổi bật</a>
                 </li>

            <li>
                    <a href="http://acegik.net/blog/categories">Danh mục</a>
                 </li>

            <li>
                    <a href="http://acegik.net/blog/about">Giới thiệu</a>
                 </li>
            
           <li><a href="http://acegik.net/blog/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

                <div class="summer-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="summer-post-meta-simple">
                            <h1>Sử dụng Regular Expression để kiểm tra tính hợp lệ của mật khẩu</h1>
                            <p>by <strong>pnhung177</strong> &#8212; on <a href="http://acegik.net/blog/tags/index.html#Java" data-toggle="tooltip" title="Posts tagged with Java" rel="tag">Java</a>&nbsp;&comma;&nbsp;<a href="http://acegik.net/blog/tags/index.html#Regular Expression" data-toggle="tooltip" title="Posts tagged with Regular Expression" rel="tag">Regular Expression</a>&nbsp;&comma;&nbsp;<a href="http://acegik.net/blog/tags/index.html#Password Policy" data-toggle="tooltip" title="Posts tagged with Password Policy" rel="tag">Password Policy</a> &#8212; <strong><time datetime="2013-10-26T00:00:00+07:00">26/10/2013</time></strong></p>
                        </div>
                    </div>
                </div>
            </header>

        <article class="summer-post-content post tag-simple">
            <div><p>Chúng ta đã làm quen với việc sử dụng Regular Expression để kiểm tra tính hợp lệ của dữ liệu. Trong phần này, chúng ta sẽ tìm hiểu về cách thức áp dụng Regular Expression để kiểm tra tính hợp lệ của mật khẩu, trong đó xây dựng cơ chế để điều chỉnh các mức độ mạnh yếu khác nhau của mật khẩu cần được kiểm tra. </p>

<p>Trong ví dụ minh họa này, chúng ta xây dựng lớp đối tượng có tên <strong>PasswordPolicyChecker</strong> thực hiện chức năng kiểm tra tính hợp lệ của mật khẩu, thông qua hàm <strong>validate()</strong> định nghĩa bên trong lớp đối tượng này.</p>

<h2 id="lp-trnh-passwordpolicychecker">Lập trình PasswordPolicyChecker</h2>

<p>Lớp đối tượng <strong>PasswordPolicyChecker</strong> cung cấp hàm <strong>validate()</strong> kiểm tra tính hợp lệ của mật khẩu cũng như cho phép người lập trình tùy chỉnh các quy tắc kiểm tra. Có hai nhóm quy tắc giúp tăng cường độ khó của mật khẩu: giới hạn về kích thước mật khẩu và các quy định về các ký tự cần phải có trong mật khẩu.</p>

<h3 id="quy-nh-v-kch-thc-mt-khu">Quy định về kích thước mật khẩu</h3>

<p>Kích thước mật khẩu là số lượng ký tự có trong mật khẩu đó. Thông thường các hệ thống đều quy định kích thước tối thiểu mật khẩu cần có. Một số hệ thống cũng quy định thêm giới hạn kích thước tối đa. Trong chương trình ví dụ minh họa, chúng ta sử dụng 2 thuộc tính để quy định giới hạn kích thước tối thiểu và tối đa cho mật khẩu:</p>

<ul>
  <li><em>minNumberOfChars</em>: xác định số lượng tối thiểu ký tự có trong mật khẩu (kích thước tối thiểu). Nếu giá trị này không thiết lập hoặc được thiết lập giá trị nhỏ hơn hoặc bằng 0, thì sẽ được tự động thiết lập lại giá trị mặc định (bằng 6).</li>
  <li><em>maxNumberOfChars</em>: xác định số lượng tối đa ký tự có trong mật khẩu (kích thước tối đa). Nếu giá trị này không thiết lập hoặc thiết lập nhỏ hơn hoặc bằng 0, thì sẽ được xem như không giới hạn tối đa, giá trị mật khẩu có thể có chiều dài không giới hạn. Nếu giá trị <em>maxNumberOfChars</em> thỏa mãn 0 &lt; <em>maxNumberOfChars</em> &lt; <em>minNumberOfChars</em> thì sẽ được gán giá trị bằng với <em>minNumberOfChars</em>.</li>
</ul>

<h3 id="quy-tc-v-k-t-c-trong-mt-khu">Quy tắc về ký tự có trong mật khẩu</h3>

<p>Phần này sẽ liệt kê các quy tắc về các ký tự có trong mật khẩu và các mẫu đối sánh (Pattern) định nghĩa trong RegExp tương ứng với các quy tắc đó. </p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">Rule</th>
      <th style="text-align: center">Pattern</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td style="text-align: center">No whitespace allowed in the entire string</td>
      <td style="text-align: center">(?=\S+$)</td>
    </tr>
    <tr>
      <td>2</td>
      <td style="text-align: center">A digit must occur at least once</td>
      <td style="text-align: center">(?=.*[0-9])</td>
    </tr>
    <tr>
      <td>3</td>
      <td style="text-align: center">A lower case letter must occur at least once</td>
      <td style="text-align: center">(?=.*[a-z])</td>
    </tr>
    <tr>
      <td>4</td>
      <td style="text-align: center">An upper case letter must occur at least once</td>
      <td style="text-align: center">(?=.*[A-Z])</td>
    </tr>
    <tr>
      <td>5</td>
      <td style="text-align: center">A special character must occur at least once</td>
      <td style="text-align: center">(?=.*[@#$%^&amp;+=])</td>
    </tr>
  </tbody>
</table>

<p>Trường hợp đơn giản nhất, mật khẩu phải đáp ứng được yêu cầu 1, đó là không được phép có ký tự trắng (whitespace) trong mật khẩu.</p>

<h3 id="la-chn-cc-quy-tc-p-dng-kim-tra">Lựa chọn các quy tắc áp dụng kiểm tra</h3>

<p>Việc lựa chọn các quy tắc áp dụng kiểm tra được thực hiện thông qua thuộc tính <em>optionFlags</em>. Thuộc tính này là một số nguyên, mỗi bit từ phải qua trái (tức là hướng từ vị trí có ý nghĩa thấp đến vị trí có ý nghĩa cao) được dùng làm một “cờ” để đánh dấu cho một quy tắc. Chẳng hạn bit số 0, là “cờ” có tên <em>FLAG_HAS_NO_WHITESPACE</em> đại diện cho quy tắc “No whitespace allowed in the entire string”, tùy thuộc giá trị cờ bằng 1 (cờ được bật) hay bằng 0 (cờ bị tắt) mà chương trình kiểm tra sẽ áp dụng hoặc bỏ qua quy tắc này.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">Rule</th>
      <th style="text-align: center">Flag</th>
      <th style="text-align: center">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td style="text-align: center">No whitespace allowed in the entire string</td>
      <td style="text-align: center">FLAG_HAS_NO_WHITESPACE</td>
      <td style="text-align: center">0x01</td>
    </tr>
    <tr>
      <td>2</td>
      <td style="text-align: center">A digit must occur at least once</td>
      <td style="text-align: center">FLAG_HAS_DIGIT</td>
      <td style="text-align: center">0x02</td>
    </tr>
    <tr>
      <td>3</td>
      <td style="text-align: center">A lower case must occur at least once</td>
      <td style="text-align: center">FLAG_HAS_LOWER_CASE</td>
      <td style="text-align: center">0x04</td>
    </tr>
    <tr>
      <td>4</td>
      <td style="text-align: center">An upper case must occur at least once</td>
      <td style="text-align: center">FLAG_HAS_UPPER_CASE</td>
      <td style="text-align: center">0x08</td>
    </tr>
    <tr>
      <td>5</td>
      <td style="text-align: center">A special character must occur at least once</td>
      <td style="text-align: center">FLAG_HAS_SPECIAL_CHARS</td>
      <td style="text-align: center">0x10</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>Để thiết lập nhiều quy tắc cùng lúc, chúng ta có thể dùng toán tử Bitwise OR (trong Java ký hiệu là</td>
      <td>) để “ghép” các quy tắc này với nhau. Giả sử với 3 quy tắc: <em>FLAG_HAS_NO_WHITESPACE</em>, <em>FLAG_HAS_DIGIT</em> và <em>FLAG_HAS_SPECIAL_CHARS</em>, chúng ta có thể thiết lập bằng lệnh:</td>
    </tr>
  </tbody>
</table>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">validator</span><span class="o">.</span><span class="na">setOptionFlags</span>
    <span class="o">(</span><span class="n">FLAG_HAS_NO_WHITESPACE</span> <span class="o">|</span> <span class="n">FLAG_HAS_DIGIT</span> <span class="o">|</span> <span class="n">FLAG_HAS_SPECIAL_CHARS</span><span class="o">);</span></code></pre></div>

<h2 id="kim-th-passwordpolicychecker">Kiểm thử PasswordPolicyChecker</h2>

<p>Chương trình kiểm thử (Unit Test) được viết trong lớp <strong>PasswordPolicyCheckerTest</strong>. Mã nguồn <a href="https://github.com/pnhung177/example-regexp-passwd-policy">ví dụ</a> được chia sẻ trên github, các bạn có thể <a href="https://github.com/pnhung177/example-regexp-passwd-policy/archive/master.zip">tải ví dụ</a> về để chạy thử trên máy tính của mình.</p>


            </div>
        </article>
        <div class="cf"></div>
        <div class="row text-center">
            <section class="summer-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Sử dụng Regular Expression để kiểm tra tính hợp lệ của mật khẩu&quot;%20http://acegik.net/blog/java/regexp/su-dung-regular-expression-de-kiem-tra-tinh-hop-le-cua-mat-khau.html%20via%20&#64;pnhung177"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=http://acegik.net/blog/java/regexp/su-dung-regular-expression-de-kiem-tra-tinh-hop-le-cua-mat-khau.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=http://acegik.net/blog/java/regexp/su-dung-regular-expression-de-kiem-tra-tinh-hop-le-cua-mat-khau.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>
        <div class="cf"></div>
        
            <div class="summer-author-info">
                <div class="row">
                    <section class="summer-post-author small-12 columns">
                        
                            <img src="http://acegik.net/blog/images/avatars/pnhung177.png" class="summer-post-author-avatar" alt="Phạm Ngọc Hùng's photo">
                        
                        
                            <span class="author-label">Author</span>
                            <h1>Phạm Ngọc Hùng</h1>
                        
                        
                            <p><a href="mailto:pnhung177@drupalex.net" class="author-website">pnhung177@drupalex.net</a></p>
                        
                        
                            <p>... when the sun comes up, you better be running!</p>
                        
                    </section>
                </div>
            </div> 
        
        <div class="cf"></div>
        
        <section class="summer-disqus row">
    <div class="small-12 columns">
        <h1 class="summer-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'acegik'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

        <div class="cf"></div>

    <footer class="summer-site-footer">
    <div class="copyright">
         <section>Bản quyền nội dung thuộc về <a href="http://acegik.net/blog/about">Phạm Ngọc Hùng</a> &copy; 2014.</section>
    </div>
    <div class="social-icons">
        
        
        <a href="http://twitter.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="https://plus.google.com/u/3/115458186421626071505">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-google-plus fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://github.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://facebook.com/pnhung177">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        
    </div>
    
    <div class="cf"></div>
</footer>
 
</main>    
    <script src="http://acegik.net/blog/assets/js/vendor/modernizr.js"></script>
    <script src="http://acegik.net/blog/assets/js/foundation.min.js"></script>
    <script src="http://acegik.net/blog/assets/js/vendor/background-check.js"></script>
    <script src="http://acegik.net/blog/assets/js/vendor/post-header-animations.js"></script>
    <script src="http://acegik.net/blog/assets/js/summer.js"></script>

    <script>
      $(document).foundation();
    </script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54128248-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>
 
</body>
</html>
